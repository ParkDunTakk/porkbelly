<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>HealCat ğŸ±</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to bottom right, #b3e5fc, #e1bee7);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }
    h1 { color: #7b1fa2; }
    .nav {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }
    .nav button {
      background: #7e57c2;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 8px 16px;
      cursor: pointer;
    }
    .nav button:hover { background: #5e35b1; }
    .page {
      display: none;
      background: white;
      border-radius: 16px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      width: 360px;
      padding: 20px;
      text-align: center;
    }
    .active { display: block; }
    .challenge {
      background-color: #f3f3f3;
      border-radius: 8px;
      padding: 10px;
      margin: 6px 0;
      cursor: pointer;
    }
    .challenge.done {
      background-color: #c8e6c9;
      text-decoration: line-through;
    }
    .badge {
      background-color: gold;
      color: black;
      padding: 5px 10px;
      border-radius: 8px;
      margin: 3px;
      display: inline-block;
      font-weight: bold;
    }
    button.action {
      background-color: #7e57c2;
      color: white;
      border: none;
      padding: 8px 14px;
      border-radius: 10px;
      margin-top: 10px;
      cursor: pointer;
    }
    button.action:hover { background-color: #5e35b1; }
    .shop-item, .decor-item {
      background: #f3e5f5;
      margin: 8px;
      border-radius: 10px;
      padding: 10px;
    }
    .room {
      position: relative;
      width: 320px;
      height: 260px;
      background-color: #fafafa;
      border-radius: 15px;
      box-shadow: inset 0 0 10px rgba(0,0,0,0.1);
      margin-bottom: 10px;
      overflow: hidden;
    }
    .cat {
      font-size: 60px;
      position: absolute;
      left: 130px;
      top: 150px;
      cursor: grab;
    }
    .decor {
      font-size: 30px;
      position: absolute;
      cursor: grab;
    }
  </style>
</head>
<body>
  <h1>ğŸ¾ HealCat</h1>
  <div class="nav">
    <button onclick="showPage('main')">ğŸ  ë©”ì¸</button>
    <button onclick="showPage('shop')">ğŸ› ì¿ í° ìƒì </button>
    <button onclick="showPage('room')">ğŸ¡ ê¾¸ë°ˆë°©</button>
  </div>

  <!-- ğŸ  ë©”ì¸ -->
  <div id="main" class="page active">
    <h2>ì˜¤ëŠ˜ì˜ ì±Œë¦°ì§€</h2>
    <div id="challengeList"></div>
    <h3>â­ í¬ì¸íŠ¸: <span id="points">0</span></h3>
    <h3>ğŸ§© ë ˆë²¨: <span id="level">1</span></h3>
    <h3>ğŸ”¥ ì¶œì„: <span id="streak">0</span>ì¼ ì—°ì†</h3>
    <h3>ğŸ… ë°°ì§€</h3>
    <div id="badgeList">ì•„ì§ ë°°ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
    <h3>ğŸ± HealCat í«</h3>
    <div id="pet" style="font-size: 60px;">ğŸ˜º</div>
    <button class="action" onclick="resetProgress()">ì´ˆê¸°í™”</button>
  </div>

  <!-- ğŸ› ì¿ í° ìƒì  -->
  <div id="shop" class="page">
    <h2>ğŸ› HealShop â€” ì¼íƒˆ ì¿ í°</h2>
    <p>í¬ì¸íŠ¸ë¡œ ì‘ì€ í–‰ë³µì„ ëˆ„ë ¤ë³´ì„¸ìš” ğŸ’«</p>
    <div id="couponShop"></div>
  </div>

  <!-- ğŸ¡ ê¾¸ë°ˆë°© -->
  <div id="room" class="page">
    <h2>ğŸ¡ ë‚˜ì˜ ê¾¸ë°ˆë°©</h2>
    <div class="room" id="roomArea">
      <div id="cat" class="cat" draggable="true">ğŸ˜º</div>
    </div>
    <h3>ğŸª„ ê¾¸ë¯¸ê¸° ì•„ì´í…œ ìƒì </h3>
    <div id="decorShop"></div>
  </div>

  <script>
    let points = 0, level = 1, streak = 0, petStage = 1;
    let badges = new Set();
    const petEmojis = ["ğŸ˜º","ğŸ˜¸","ğŸ˜»"];
    const decorItems = [];
    const today = new Date().toDateString();
    const lastVisit = localStorage.getItem("lastVisit");

    // ====== ì¶œì„ ë³´ìƒ ======
    if (lastVisit !== today) {
      streak = Number(localStorage.getItem("streak") || 0) + 1;
      localStorage.setItem("streak", streak);
      localStorage.setItem("lastVisit", today);
      points += 50; // ğŸ ì¶œì„ ë³´ìƒ
      alert("ğŸ‰ ì˜¤ëŠ˜ë„ ì˜¤ì…¨êµ°ìš”! ì¶œì„ ë³´ìƒìœ¼ë¡œ 50í¬ì¸íŠ¸ íšë“!");
    } else {
      streak = Number(localStorage.getItem("streak") || 0);
    }

    // ====== ì±Œë¦°ì§€ ======
    const challenges = [
      { id: 1, text: "ë¬¼ 2L ë§ˆì‹œê¸°", done: false },
      { id: 2, text: "30ë¶„ ìš´ë™í•˜ê¸°", done: false },
      { id: 3, text: "ì•¼ì‹ ì•ˆ ë¨¹ê¸°", done: false },
    ];

    // ====== ì¼íƒˆ ì¿ í° ======
    const coupons = [
      { id: 1, name: "ğŸ° ì¹˜íŠ¸ë°ì´ ì¿ í°", cost: 300, desc: "ì˜¤ëŠ˜ì€ ë””ì €íŠ¸ OK!" },
      { id: 2, name: "â˜• íœ´ì‹ íŒ¨ìŠ¤", cost: 200, desc: "ìš´ë™ ê±´ë„ˆë›°ê¸° 1íšŒ" },
      { id: 3, name: "ğŸ¬ ì˜í™” ë³´ê¸° ì¿ í°", cost: 400, desc: "ì¢‹ì•„í•˜ëŠ” ì˜í™” í•œ í¸!" },
      { id: 4, name: "ğŸ¿ ì•¼ì‹ í—ˆìš©ê¶Œ", cost: 250, desc: "ì˜¤ëŠ˜ì€ ì•¼ì‹ë„ ê´œì°®ì•„!" },
      { id: 5, name: "ğŸ›‹ í™ˆì¹´í˜ íƒ€ì„", cost: 350, desc: "ì»¤í”¼ í•œ ì”ì˜ ì—¬ìœ  â˜•" },
      { id: 6, name: "ğŸŒ„ ì™¸ì¶œ íŒ¨ìŠ¤", cost: 500, desc: "ê°€ë³ê²Œ ì‚°ì±…í•˜ëŸ¬ ë‚˜ê°€ê¸°!" }
    ];

    // ====== ê¾¸ë¯¸ê¸° ìƒì  ======
    const decorShopItems = [
      { id: 1, name: "ğŸ€ ë¦¬ë³¸", cost: 150, emoji: "ğŸ€" },
      { id: 2, name: "ğŸª´ í™”ë¶„", cost: 250, emoji: "ğŸª´" },
      { id: 3, name: "ğŸŒ¼ ê½ƒì¥ì‹", cost: 200, emoji: "ğŸŒ¼" },
      { id: 4, name: "ğŸ•¯ ìº”ë“¤", cost: 300, emoji: "ğŸ•¯" },
      { id: 5, name: "ğŸ§¸ ì¸í˜•", cost: 400, emoji: "ğŸ§¸" },
    ];

    // ====== í˜ì´ì§€ ì „í™˜ ======
    function showPage(id) {
      document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
      document.getElementById(id).classList.add("active");
    }

    // ====== UI ì—…ë°ì´íŠ¸ ======
    function updateUI() {
      document.getElementById("points").textContent = points;
      document.getElementById("level").textContent = level;
      document.getElementById("streak").textContent = streak;
      document.getElementById("pet").textContent = petEmojis[petStage - 1];
      document.getElementById("cat").textContent = petEmojis[petStage - 1];
      const badgeContainer = document.getElementById("badgeList");
      badgeContainer.innerHTML = badges.size
        ? [...badges].map(b => `<span class="badge">${b}</span>`).join("")
        : "ì•„ì§ ë°°ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.";
    }

    // ====== ì±Œë¦°ì§€ ======
    function toggleChallenge(id) {
      const c = challenges.find(ch => ch.id === id);
      c.done = !c.done;
      if (c.done) {
        points += 50;
        if (points % 100 === 0) level++;
        if (points % 200 === 0 && petStage < 3) petStage++;
        badges.add("ë„ì „ì™• ğŸ¥‡");
      } else points = Math.max(0, points - 50);
      renderChallenges(); updateUI();
    }

    function renderChallenges() {
      const list = document.getElementById("challengeList");
      list.innerHTML = "";
      challenges.forEach(c => {
        const div = document.createElement("div");
        div.className = "challenge" + (c.done ? " done" : "");
        div.textContent = c.text;
        div.onclick = () => toggleChallenge(c.id);
        list.appendChild(div);
      });
    }

    // ====== ì¿ í° ìƒì  ======
    function renderCouponShop() {
      const list = document.getElementById("couponShop");
      list.innerHTML = "";
      coupons.forEach(item => {
        const div = document.createElement("div");
        div.className = "shop-item";
        div.innerHTML = `
          <strong>${item.name}</strong> â€” ${item.cost}ì <br>
          <small>${item.desc}</small><br>
          <button class="action" onclick="buyCoupon(${item.id})">êµ¬ë§¤</button>
        `;
        list.appendChild(div);
      });
    }

    function buyCoupon(id) {
      const item = coupons.find(i => i.id === id);
      if (points >= item.cost) {
        points -= item.cost;
        alert(`âœ… ${item.name} êµ¬ë§¤ ì™„ë£Œ!\n${item.desc}`);
        updateUI();
      } else alert("í¬ì¸íŠ¸ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤!");
    }

    // ====== ê¾¸ë¯¸ê¸° ======
    function renderDecorShop() {
      const list = document.getElementById("decorShop");
      list.innerHTML = "";
      decorShopItems.forEach(item => {
        const div = document.createElement("div");
        div.className = "decor-item";
        div.innerHTML = `
          <strong>${item.name}</strong> â€” ${item.cost}ì <br>
          <button class="action" onclick="buyDecor(${item.id})">êµ¬ë§¤</button>
        `;
        list.appendChild(div);
      });
    }

    function buyDecor(id) {
      const item = decorShopItems.find(i => i.id === id);
      if (points >= item.cost) {
        points -= item.cost;
        addDecor(item.emoji);
        alert(`ğŸ‰ ${item.name}ì„(ë¥¼) ë°©ì— ì¶”ê°€í–ˆìŠµë‹ˆë‹¤!`);
        updateUI();
      } else alert("í¬ì¸íŠ¸ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤!");
    }

    function addDecor(emoji) {
      const room = document.getElementById("roomArea");
      const deco = document.createElement("div");
      deco.className = "decor";
      deco.textContent = emoji;
      deco.style.left = Math.random() * 280 + "px";
      deco.style.top = Math.random() * 200 + "px";
      deco.draggable = true;

      // ë“œë˜ê·¸ ì´ë™
      deco.addEventListener("dragstart", e => {
        e.dataTransfer.setData("text/plain", null);
        deco.dataset.dragging = "true";
      });
      deco.addEventListener("dragend", e => {
        deco.style.left = e.pageX - room.offsetLeft - 20 + "px";
        deco.style.top = e.pageY - room.offsetTop - 50 + "px";
        deco.dataset.dragging = "false";
      });

      room.appendChild(deco);
      decorItems.push(emoji);
    }

    // ====== ì´ˆê¸°í™” ======
    function resetProgress() {
      points = 0; level = 1; petStage = 1;
      badges.clear(); challenges.forEach(c => c.done = false);
      localStorage.clear(); streak = 0;
      document.getElementById("roomArea").innerHTML = '<div id="cat" class="cat" draggable="true">ğŸ˜º</div>';
      renderChallenges(); renderCouponShop(); renderDecorShop(); updateUI();
    }

    // ====== ì‹¤í–‰ ======
    renderChallenges();
    renderCouponShop();
    renderDecorShop();
    updateUI();
  </script>
</body>
</html>
